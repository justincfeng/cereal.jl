<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Locator Functions · cereal.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">cereal.jl</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li class="is-active"><a class="tocitem" href="locatorfuncs.html">Locator Functions</a><ul class="internal"><li><a class="tocitem" href="#Locator-function-selector"><span>Locator function selector</span></a></li><li><a class="tocitem" href="#Basic-method-functions"><span>Basic method functions</span></a></li><li><a class="tocitem" href="#Multi-locator-function"><span>Multi locator function</span></a></li></ul></li><li><a class="tocitem" href="evaluation.html">Evaluation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="locatorfuncs.html">Locator Functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="locatorfuncs.html">Locator Functions</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/justincfeng/cereal.jl/blob/master/docs/src/locatorfuncs.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Methods-and-Locator-Functions"><a class="docs-heading-anchor" href="#Methods-and-Locator-Functions">Methods and Locator Functions</a><a id="Methods-and-Locator-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Methods-and-Locator-Functions" title="Permalink"></a></h1><h2 id="Locator-function-selector"><a class="docs-heading-anchor" href="#Locator-function-selector">Locator function selector</a><a id="Locator-function-selector-1"></a><a class="docs-heading-anchor-permalink" href="#Locator-function-selector" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="cereal.locatorselect" href="#cereal.locatorselect"><code>cereal.locatorselect</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Locator selection function.</p><pre><code class="nohighlight hljs">locatorselect( N::Int , Method::String )</code></pre><p>The function <code>locatorselect</code> selects the locator function to use. The first argument <code>N</code> determines the minimum number of emission points that the locator function will use. <code>N=4</code> or <code>N≥5</code> is recommended. The second argument <code>Method</code> selects the formula or algorithm used to compute the intersection point <span>$X_c$</span>. The available methods are <code>&quot;FHC21&quot;</code>, <code>&quot;CFM10&quot;</code>, and for <code>N≥5</code>, <code>&quot;RTC21&quot;</code>.</p><p>By default, the locator function assumes <code>N=5</code> and <code>Method=&quot;RTC21&quot;</code>:</p><pre><code class="nohighlight hljs">julia&gt; locatorselect() == locatorselect(5,&quot;RTC21&quot;)
true</code></pre></div></section></article><h2 id="Basic-method-functions"><a class="docs-heading-anchor" href="#Basic-method-functions">Basic method functions</a><a id="Basic-method-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-method-functions" title="Permalink"></a></h2><h3 id="The-RTC21-method"><a class="docs-heading-anchor" href="#The-RTC21-method">The <code>RTC21</code> method</a><a id="The-RTC21-method-1"></a><a class="docs-heading-anchor-permalink" href="#The-RTC21-method" title="Permalink"></a></h3><p>The <code>RTC21</code> formula of Ruggiero, Tartaglia, and Casalino (2021) [arxiv:2111.13423] is the preferred method, since it is the fastest and most accurate, despite requring an additional emission point. The calculation is rather staightforward; first define the matrix <span>$\mathcal{M}$</span> and the vector <span>$B$</span>:</p><p class="math-container">\[\mathcal{M} = 2
  \left[
  \begin{array}{cccc}
    t_1-t_2  &amp;  x_2-x_1  &amp;  y_2-y_1  &amp;  z_2-z_1 \\
    t_2-t_3  &amp;  x_3-x_2  &amp;  y_3-y_2  &amp;  z_3-z_2 \\
    t_3-t_4  &amp;  x_4-x_3  &amp;  y_4-y_3  &amp;  z_4-z_3 \\
    t_4-t_5  &amp;  x_5-x_4  &amp;  y_5-y_4  &amp;  z_5-z_4 \\
  \end{array}
  \right] ,\]</p><p class="math-container">\[B = 
  \left[
  \begin{array}{cccc}
    x_2^2-x_1^2 + y_2^2-y_1^2 + z_2^2-z_1^2 + t_1^2-t_2^2 \\
    x_3^2-x_2^2 + y_3^2-y_2^2 + z_3^2-z_2^2 + t_2^2-t_3^2 \\
    x_4^2-x_3^2 + y_4^2-y_3^2 + z_4^2-z_3^2 + t_3^2-t_4^2 \\
    x_5^2-x_4^2 + y_5^2-y_4^2 + z_5^2-z_4^2 + t_4^2-t_5^2 \\
  \end{array}
  \right] .\]</p><p>The intersection point <span>$X_c$</span> is then given by:</p><p class="math-container">\[X_c = \mathcal{M}^{-1} B .\]</p><p>This method is implemented in the following function:</p><article class="docstring"><header><a class="docstring-binding" id="cereal.locator5RTC21" href="#cereal.locator5RTC21"><code>cereal.locator5RTC21</code></a> — <span class="docstring-category">Function</span></header><section><div><p><strong>Five point locator function (RTC21)</strong></p><pre><code class="nohighlight hljs">locator5RTC21( X::RealMtx )</code></pre><p>The function presented here implements the five point relativistic  location formula given by Ruggiero, Tartaglia, and Casalino in  Ruggiero et al., arxiv:2111.13423 (2021).</p></div></section></article><h3 id="The-FHC21-method"><a class="docs-heading-anchor" href="#The-FHC21-method">The <code>FHC21</code> method</a><a id="The-FHC21-method-1"></a><a class="docs-heading-anchor-permalink" href="#The-FHC21-method" title="Permalink"></a></h3><p>The <code>FHC21</code> method is a method developed by the authors, which shows slight improvement over the <code>CFM10</code> method.</p><p>The algorithm is conceptually simple for a spacelike hyperplane:</p><ol><li><p>Find and perform a Lorentz transformation such that the four points  <span>$X_i$</span> (labeled with <span>$i∈$</span>{1,2,3,4}) have the same time coordinate  in the transformed frame. In the transformed frame, the four points  form a tetrahedron in space at some instant in time.</p></li><li><p>Assuming the tetrahedron has finite volume, find the circumcenter and  circumradius. The circumcenter provides the spatial coordinates of  the intersection point in the new frame, and the circumradius  provides the time coordinate (via time of flight).</p></li><li><p>Transform back to obtain the coordinates of the intersection point in  the original frame.</p></li></ol><p>The computed point <span>$X_c$</span> should satisfy the four constraints</p><p class="math-container">\[dX_I^2:=η_{μν}(X_c^μ-X^μ_I)(X_c^ν-X^ν_I)=0,\]</p><p>where <span>$μ$</span>, <span>$ν$</span> are spacetime indices and <span>$η_{μν}$</span> is the Minkowski  metric. </p><p>The case of a timelike hyperplane is conceptually similar, but more intricate:</p><ol><li><p>Find and perform a Lorentz transformation such that the four points  <span>$X_I$</span> (labeled with <span>$I∈$</span> {1,2,3,4}) lie on a plane <span>$P_z$</span>  specified by a <span>$z$</span> coordinate in the transformed frame. In the  transformed frame, the four points lie on an elliptic hyperboloid.</p></li><li><p>Find the vertex of the hyperboloid, and the Minkowski distance <span>$R$</span>  from the vertex to a point on the hyperboloid. There are two  intersection points. The <span>$z$</span> coordinate for the intersection  points is a distance <span>$R$</span> in the direction normal to the <span>$P_z$</span>  plane.</p></li><li><p>Transform back to obtain the coordinates of the intersection point in  the original frame.</p></li></ol><p>There are two intersection points in the case of a timelike hyperplane; this is known as the bifurcation problem (Coll et al., Phys. Rev. D 86, 084036 (2012)). The addition of a fifth emission point will in most cases permit the selection of a single emission point.</p><p>The method described above is implemented in the following function:</p><article class="docstring"><header><a class="docstring-binding" id="cereal.locator4FHC21" href="#cereal.locator4FHC21"><code>cereal.locator4FHC21</code></a> — <span class="docstring-category">Function</span></header><section><div><p><strong>Four point locator function (FHC21)</strong></p><pre><code class="nohighlight hljs">locator4FHC21( X::RealMtx )</code></pre><p>This function implements the four point relativistic location algorithm of the authors. It outputs a pair of location points.</p></div></section></article><h3 id="The-CFM10-method"><a class="docs-heading-anchor" href="#The-CFM10-method">The <code>CFM10</code> method</a><a id="The-CFM10-method-1"></a><a class="docs-heading-anchor-permalink" href="#The-CFM10-method" title="Permalink"></a></h3><p>The <code>CFM10</code> method is the original four point relativistic location formula given by Coll, Ferrando, and Morales-Lladosa: </p><p class="math-container">\[X_c^μ = X_4^μ + y_*^μ - \frac{η(y_*,y_*)}{η(y_*,χ)±\sqrt{|Δ|}} χ^μ, \]</p><p>where the following are defined:</p><p class="math-container">\[Δ := η(y_*,χ)^2 - η(y_*,y_*) η(χ,χ) \]</p><p class="math-container">\[y_*^μ := \frac{1}{η(ξ,χ)} (i_ξ H)^μ \]</p><p class="math-container">\[H := Ω_1 h(e_2,e_3) + Ω_2 h(e_3,e_1) + Ω_3 h(e_1,e_2)\]</p><p class="math-container">\[Ω_i := η(e_i,e_i)\]</p><p class="math-container">\[χ^μ = η^{μσ} ϵ_{σαβγ} e_1^α e_2^β e_3^γ\]</p><p class="math-container">\[e_i^μ = X_i^μ - X_4^μ \]</p><p>where <span>$h(U,V)$</span> yields the rank-2 tensor <span>$-ϵ_{αβμν} U^μ U^ν$</span> (so that <span>$H$</span> is a rank-2 quantity), and <span>$ξ^μ$</span> is an arbitrary vector which we choose to satisfy <span>$η(ξ,χ)=1$</span>. See See Coll et al., Class.Quant.Grav. 27 (2010) 065013 and Coll et al., Phys. Rev. D 86, 084036 (2012) for the details of the derivation.</p><p>The method describe above is implemented in the following function:</p><article class="docstring"><header><a class="docstring-binding" id="cereal.locator4CFM10" href="#cereal.locator4CFM10"><code>cereal.locator4CFM10</code></a> — <span class="docstring-category">Function</span></header><section><div><p><strong>Four point locator function (CFM10)</strong></p><pre><code class="nohighlight hljs">locator4CFM10( X::RealMtx )</code></pre><p>The function presented here implements the four point relativistic location formula given by Coll, Ferrando, and Morales-Lladosa. It outputs a pair of location points.</p></div></section></article><h2 id="Multi-locator-function"><a class="docs-heading-anchor" href="#Multi-locator-function">Multi locator function</a><a id="Multi-locator-function-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-locator-function" title="Permalink"></a></h2><p>Given a large number of emission points, one can reduce errors and avoid the bifurcation problem. A multi locator function is implemented here, which computes the intersection point <span>$X_c$</span>. Given an <span>$m×n$</span> matrix <code>X</code> of <span>$n$</span> emission points, and a function <code>locator</code> designed to work with <code>Nbase</code><span>$&lt;n$</span> emission points, this function is designed to minimize errors and solve the bifurcation problem when needed.</p><p>For <code>locator</code> functions designed to work with <span>$N = 4$</span> emission points, the bifurcation problem is solved by way of a rudimentary clustering algorithm. The clustering algorithm sorts points according to their norms and identifies closely clustered points according to the differences between the neighbors of the sorted points, and the tolerance parameter <code>q</code>.</p><p>In all cases, the errors are minimized by sorting points according to their Minkowski norms and selecting the point with the smallest norm.</p><article class="docstring"><header><a class="docstring-binding" id="cereal.mlocator" href="#cereal.mlocator"><code>cereal.mlocator</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Multiple emission set locator</p><pre><code class="nohighlight hljs">mlocator( X::RealMtx , locator::Function , Nbase::Int , dual::Bool, q::Real )</code></pre><p>The function <code>mlocator</code> computes a single intersection point <span>$X_c$</span> for a large number of emission points <code>X</code>, given a locator function <code>locator</code>.</p></div></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="index.html">« Home</a><a class="docs-footer-nextpage" href="evaluation.html">Evaluation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 3 December 2021 19:55">Friday 3 December 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
